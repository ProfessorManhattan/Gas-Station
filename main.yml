---
# - import_playbook: playbooks/terminal.yml
#   vars:
#     install_roles:
#       - tabby
#       - hyper
# - import_playbook: playbooks/anonimity.yml
# - import_playbook: playbooks/automation.yml
# - import_playbook: playbooks/backup.yml
# - import_playbook: playbooks/base.yml
# - import_playbook: playbooks/ci-cd-agent.yml
# - import_playbook: playbooks/cli-utilities.yml
# - import_playbook: playbooks/cloud-cli.yml
# - import_playbook: playbooks/collaboration.yml
# - import_playbook: playbooks/containers.yml
# - import_playbook: playbooks/crypto.yml
# - import_playbook: playbooks/desktop-utilities.yml
# - import_playbook: playbooks/developer-tools.yml
# - import_playbook: playbooks/email.yml
# - import_playbook: playbooks/file-sharing.yml
# - import_playbook: playbooks/freeipa.yml
# - import_playbook: playbooks/git-tools.yml
# - import_playbook: playbooks/image.yml
# - import_playbook: playbooks/init.yml
# - import_playbook: playbooks/languagemanagers.yml
# - import_playbook: playbooks/languages.yml
# - import_playbook: playbooks/monitoring.yml
# - import_playbook: playbooks/multimedia.yml
# - import_playbook: playbooks/network-tools.yml
# - import_playbook: playbooks/office.yml
# - import_playbook: playbooks/remote-connection.yml
# - import_playbook: playbooks/screenshot-screencast.yml
# - import_playbook: playbooks/secret.yml
# - import_playbook: playbooks/terminal.yml
# - import_playbook: playbooks/virtualization.yml
# - import_playbook: playbooks/vpn.yml
# - import_playbook: playbooks/web-browser.yml

- name: Prepare connection and variables
  hosts: all
  gather_facts: false
  roles:
    - roles/system/connect

- name: Provision the firewall and network controller
  hosts: pfsense
  roles:
    - roles/misc/pfsense
    - roles/misc/unifi

- name: Setup the IDS
  hosts: seconion
  roles:
    - roles/misc/seconion

- name: Reformat network
  hosts: all:!pfsense:!seconion
  roles:
    - role: roles/misc/wipe
      when: false

- name: Setup VM controller and network
  hosts: maas
  roles:
    - roles/misc/maas

- name: Configure systems with common settings and applications
  hosts: all:!pfsense:!seconion
  roles:
    - roles/system/fuse
    - roles/tools/starship # Developer note - dotfiles role needs starship installed before it runs
    - roles/system/dotfiles
    - roles/system/zsh
    - roles/system/tmux
    - roles/system/motd
    - roles/tools/mas
    - roles/services/antivirus
    - roles/services/cups
    - role: roles/services/dnsmasq
      when: install_dnsmasq | default(false)
    - roles/services/nginx
    - role: roles/services/portout
      when: install_portout | default(false)
    - roles/system/santa

# - hosts: desktop
#  roles:
#    - roles/services/zenbot # Zenbot: Automated cryptocurrency trading tool

- name: Finish configuring systems
  hosts: all:!pfsense:!seconion
  roles:
    # - roles/misc/easyengine
    # - roles/misc/hosthomepage
    - roles/system/finish
